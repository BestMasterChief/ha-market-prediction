# Market Prediction System v2.2.3

## ‚ö†Ô∏è IMPORTANT FINANCIAL DISCLAIMER ‚ö†Ô∏è

**THIS INTEGRATION IS FOR EDUCATIONAL AND INFORMATIONAL PURPOSES ONLY. IT IS NOT INTENDED TO PROVIDE FINANCIAL, INVESTMENT, OR TRADING ADVICE.**

- **NOT FINANCIAL ADVICE**: The predictions generated by this system are algorithmic estimates based on technical analysis and sentiment data. They should NOT be considered as financial advice, investment recommendations, or trading signals.
- **NO GUARANTEE OF ACCURACY**: Market predictions are inherently uncertain and past performance does not guarantee future results. The system's predictions may be incorrect and should not be relied upon for investment decisions.
- **CONSULT PROFESSIONALS**: Always consult with qualified financial advisors, investment professionals, or conduct your own research before making any investment decisions.
- **USE AT YOUR OWN RISK**: Any financial losses incurred from decisions based on this system's output are solely your responsibility.

---

A sophisticated Home Assistant integration that predicts S&P 500 and FTSE 100 market movements using Renaissance Technologies-inspired quantitative analysis, combining technical indicators with multi-source sentiment analysis.

<p align="center">
  <a href="https://www.buymeacoffee.com/bestmasterchief" target="_blank">
    <img src="https://img.shields.io/badge/Buy&nbsp;me&nbsp;a&nbsp;coffee-Support&nbsp;Dev-yellow?style=for-the-badge&logo=buy-me-a-coffee" alt="Buy Me A Coffee">
  </a>
</p>

## Features

### üîÆ Market Predictions
- **S&P 500 & FTSE 100 Forecasts**: Daily market direction predictions with confidence scores
- **Renaissance Technologies Algorithm**: Quantitative approach combining technical (75%) and sentiment (25%) analysis
- **Real-time Progress Tracking**: Visual progress updates during 5-10 minute analysis cycles
- **Multi-factor Analysis**: RSI, momentum, moving averages, volatility, and volume indicators

### üìä Advanced Sentiment Analysis
- **10 Financial News Sources**: Bloomberg, Reuters, Financial Times, Wall Street Journal, CNBC, and more
- **Weighted Source Reliability**: Professional sources receive higher weights in analysis
- **Current Source Tracking**: Real-time display of which news source is being processed
- **Processing Time Estimates**: ETA calculations for completion

### üè† Home Assistant Integration
- **6 Sensor Entities**: Market predictions, progress tracking, status monitoring, and processing metrics
- **Dashboard Ready**: Pre-configured cards for immediate integration
- **Automation Support**: Trigger automations based on market predictions
- **Error Handling**: Comprehensive error recovery and status reporting
- **Options Flow**: Configure update intervals and analysis settings after setup

### üîß Configuration
- **UI Configuration**: Set up API keys through Home Assistant's interface
- **Reconfiguration Support**: Change settings anytime via the Configure button
- **Optional APIs**: Alpha Vantage (required) + Financial Modeling Prep (optional for enhanced sentiment)
- **Rate Limiting**: Built-in API quota management and throttling
- **Update Scheduling**: Configurable prediction refresh intervals

## Installation

### HACS Installation (Recommended)

1. **Add Custom Repository**:
   - Open HACS in Home Assistant
   - Click the three dots menu ‚Üí "Custom repositories"
   - Add URL: `https://github.com/BestMasterChief/ha-market-prediction`
   - Category: "Integration"
   - Click "ADD"

2. **Install Integration**:
   - Search for "Market Prediction System" in HACS
   - Click "Download"
   - Restart Home Assistant

3. **Configure Integration**:
   - Go to Settings ‚Üí Devices & Services
   - Click "Add Integration"
   - Search for "Market Prediction System"
   - Enter your Alpha Vantage API key (required)
   - Optionally enter Financial Modeling Prep API key
   - Configure update intervals and prediction times
   - Click "Submit"

### Manual Installation

1. **Download Files**:
   ```bash
   cd /config/custom_components/
   git clone https://github.com/BestMasterChief/ha-market-prediction.git
   mv ha-market-prediction/custom_components/market_prediction ./
   rm -rf ha-market-prediction
   ```

2. **Restart Home Assistant**

3. **Configure via UI** (same as HACS method above)

## API Keys Setup

### Alpha Vantage (Required)
- **Free Tier**: 500 API calls per day
- **Get API Key**: [https://www.alphavantage.co/support/#api-key](https://www.alphavantage.co/support/#api-key)
- **Used For**: Market data, technical analysis, basic sentiment

### Financial Modeling Prep (Optional)
- **Free Tier**: 250 API calls per day
- **Get API Key**: [https://financialmodelingprep.com/developer/docs](https://financialmodelingprep.com/developer/docs)
- **Used For**: Enhanced sentiment analysis, additional news sources

## Configuration Options

After initial setup, you can reconfigure the integration at any time:

1. **Go to Settings ‚Üí Devices & Services**
2. **Find "Market Prediction System"**
3. **Click "Configure"** to change API keys and intervals
4. **Click "Options"** to adjust analysis settings

### Available Options:
- **Update Interval**: How often predictions refresh (1-24 hours)
- **Prediction Times**: When to run analysis (e.g., "06:30,12:00,17:30")
- **Weekend Analysis**: Enable/disable weekend market analysis
- **Confidence Threshold**: Minimum confidence for predictions (10-95%)
- **Max Prediction Change**: Cap predictions at realistic levels (1-10%)

## Sensor Entities

| Entity | Description | Example State |
|--------|-------------|---------------|
| `sensor.s_p_500_prediction` | S&P 500 market direction forecast | "UP 2.3%" |
| `sensor.ftse_100_prediction` | FTSE 100 market direction forecast | "DOWN 1.5%" |
| `sensor.market_prediction_progress` | Analysis progress percentage | 85% |
| `sensor.market_prediction_status` | Current processing stage | "Processing Sentiment Analysis" |
| `sensor.market_prediction_current_source` | Source being analyzed | "Bloomberg Market (item 3/10)" |
| `sensor.market_prediction_processing_time` | Total analysis time | 6.8 minutes |

## Dashboard Example

```yaml
type: entities
title: Market Predictions
entities:
  - entity: sensor.s_p_500_prediction
    name: S&P 500 Forecast
    icon: mdi:trending-up
  - entity: sensor.ftse_100_prediction
    name: FTSE 100 Forecast
    icon: mdi:trending-down
  - entity: sensor.market_prediction_progress
    name: Analysis Progress
  - entity: sensor.market_prediction_current_source
    name: Current Source
  - entity: sensor.market_prediction_processing_time
    name: Processing Time
```

## Automation Example

```yaml
automation:
  - alias: "Market Prediction Alert"
    trigger:
      - platform: state
        entity_id: sensor.s_p_500_prediction
    condition:
      - condition: template
        value_template: "{{ 'UP' in trigger.to_state.state and state_attr('sensor.s_p_500_prediction', 'confidence') > 80 }}"
    action:
      - service: notify.mobile_app_your_phone
        data:
          title: "Market Alert"
          message: "S&P 500 predicted {{ trigger.to_state.state }} with {{ state_attr('sensor.s_p_500_prediction', 'confidence') }}% confidence"
```

## Algorithm Details

### Technical Analysis (75% Weight)
- **RSI Analysis (25%)**: 14-day Relative Strength Index for overbought/oversold conditions
- **Momentum Analysis (30%)**: 5-day price momentum evaluation
- **Moving Average Analysis (25%)**: 5-day and 10-day trend convergence
- **Volume Analysis (15%)**: Trading volume confirmation signals
- **Volatility Assessment (5%)**: Price volatility impact on prediction confidence

### Sentiment Analysis (25% Weight)
- **Multi-Source Processing**: 10 financial news sources with reliability weighting
- **Natural Language Processing**: Keyword-based sentiment scoring
- **Source Reliability**: Professional sources (Bloomberg, Reuters) weighted higher
- **Real-time Tracking**: Live updates on source processing status

### Prediction Calculation
- Combines technical and sentiment scores using Renaissance Technologies-inspired weighting
- Predictions capped at realistic ¬±4% movements
- Confidence scoring based on signal strength and consensus
- Risk management through prediction validation

## Troubleshooting

### Common Issues

**"No prediction data available"**
- Check API keys are correctly configured
- Verify internet connectivity
- Check Home Assistant logs for API errors

**Sensors showing "unavailable"**
- Ensure integration is properly loaded
- Check that API quotas haven't been exceeded
- Restart the integration if needed

**Progress stuck at 100% immediately**
- This typically indicates an API error
- Check logs for specific error messages
- Verify API keys are valid and active

**"sensor no longer has a state class" error**
- This is resolved in v2.2.3 with proper state_class definitions
- Restart Home Assistant after updating

### Debug Logging

Add to `configuration.yaml`:
```yaml
logger:
  default: warning
  logs:
    custom_components.market_prediction: debug
```

## Versions and Updates

The integration supports automatic updates through HACS when new versions are released. Release notes and changelogs are provided with each update to track new features and bug fixes.

### Current Version: 2.2.3
- ‚úÖ Fixed Home Assistant 2025 state_class compatibility
- ‚úÖ Fixed GitHub validation errors (HACS and flake8)
- ‚úÖ Added Options Flow for reconfiguration
- ‚úÖ Enhanced multi-source sentiment analysis
- ‚úÖ Real-time progress tracking with source display
- ‚úÖ Improved error handling and API validation

### Update Log
- **v2.2.3**: Fixed state_class errors, added options flow, GitHub validation fixes
- **v2.2.2**: Enhanced sentiment analysis, improved progress tracking
- **v2.2.1**: Home Assistant 2025 compatibility updates
- **v2.2.0**: Multi-source sentiment analysis implementation

## Support

- **Issues**: [GitHub Issues](https://github.com/BestMasterChief/ha-market-prediction/issues)
- **Documentation**: [GitHub Repository](https://github.com/BestMasterChief/ha-market-prediction)
- **Community**: Home Assistant Community Forum

## License

This project is licensed under the MIT License - see the [LICENSE](LICENSE) file for details.

---

**Remember**: This integration is a tool for analysis and education. Always make investment decisions based on your own research and professional financial advice.